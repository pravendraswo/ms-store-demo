# GHAS Test Vulnerabilities Summary

This document outlines the intentional security vulnerabilities added to test GitHub Advanced Security (GHAS) code scanning capabilities.

## 1. SQL Injection Vulnerability

**Location:** `src/MicrosoftToys.Api/Controllers/ProductsController.cs` (lines 35-49)

**Type:** SQL Injection (CWE-89)

**Description:** The new `SearchProducts` endpoint directly concatenates user input (`searchTerm` parameter) into a SQL query without parameterization.

**Vulnerable Code:**
```csharp
string query = "SELECT * FROM Products WHERE Name LIKE '%" + searchTerm + "%'";
```

**Expected Detection:** CodeQL should flag this as a SQL injection vulnerability.

**Risk Level:** High

---

## 2. Command Injection Vulnerability

**Location:** `src/MicrosoftToys.Api/Controllers/OrdersController.cs` (lines 34-46)

**Type:** Command Injection (CWE-78)

**Description:** The new `ExportOrder` endpoint directly uses user input (`fileName` parameter) in a system command execution without validation or sanitization.

**Vulnerable Code:**
```csharp
process.StartInfo.Arguments = "/c echo Exporting to " + fileName;
```

**Expected Detection:** CodeQL should flag this as a command injection vulnerability.

**Risk Level:** High

---

## 3. Vulnerable Dependencies

**Location:** `src/MicrosoftToys.Api/MicrosoftToys.Api.csproj`

### Newtonsoft.Json 10.0.1
- **Known Vulnerabilities:** Improper Handling of Exceptional Conditions (GHSA-5crp-9r3c-p9vr)
- **Affected Versions:** < 13.0.1
- **Patched Version:** 13.0.1
- **Risk Level:** High
- **Expected Detection:** Dependabot should create an alert and suggest upgrading to version 13.0.1 or later

### System.Data.SqlClient 4.8.2
- **Known Vulnerabilities:** SQL Data Provider Security Feature Bypass (GHSA-8g2p-5pqh-5jmc, GHSA-98g6-xh36-x2p7)
- **Affected Versions:** < 4.8.6
- **Patched Version:** 4.8.6 (or migrate to Microsoft.Data.SqlClient)
- **Risk Level:** Moderate to High
- **Expected Detection:** Dependabot should create alerts and suggest upgrading to version 4.8.6 or migrating to Microsoft.Data.SqlClient

---

## Testing Instructions

1. **CodeQL Scanning**: Wait for the GitHub Actions workflow to complete and check the Security tab for code scanning alerts
2. **Dependabot Alerts**: Check the Security > Dependabot alerts tab for vulnerable dependency notifications
3. **NuGet Warnings**: Build warnings already show during compilation:
   ```
   warning NU1903: Package 'Newtonsoft.Json' 10.0.1 has a known high severity vulnerability
   warning NU1902: Package 'System.Data.SqlClient' 4.8.2 has a known moderate severity vulnerability
   warning NU1903: Package 'System.Data.SqlClient' 4.8.2 has a known high severity vulnerability
   ```

## Notes

**⚠️ IMPORTANT:** These vulnerabilities are intentionally added for testing purposes only. They should **NOT** be deployed to production environments and should be removed after GHAS testing is complete.
